<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>

	<query name="newSoftwareFilterCount">
		<![CDATA[
		select
			count(*) 
		from
			SoftwareFilter sf
		where
			sf.status = 'NEW'
		]]>
	</query>

	<query name="softwareFiltersByProduct">
		<![CDATA[
		from SoftwareFilter s 
		
		where	
			s.product = :product
			
		]]>
	</query>

	<query name="softwareFiltersByIdList">
		<![CDATA[
		from SoftwareFilter s 

		where	
			s.softwareFilterId in ( :ids )

		]]>
	</query>

	<query name="softwareFilterById">
		<![CDATA[
		from SoftwareFilter s
        join fetch s.product
		where
			s.softwareFilterId = :softwareFilterId 

		]]>
	</query>

	<query name="softwareFilterHistory">
		<![CDATA[
		from SoftwareFilterH s 
		join fetch s.product
		where	
			s.softwareFilter = :softwareFilter

		]]>
	</query>

	<query name="softwareFiltersByNameAndStatus">
		<![CDATA[
		from SoftwareFilter s

		join fetch s.product

		where
			upper(s.softwareName) like :softwareName  and
			s.status = :status

		]]>
	</query>


	<query name="softwareFiltersByName">
		<![CDATA[
		from SoftwareFilter s

		join fetch s.product

		where
			upper(s.softwareName) like :softwareName 

		]]>
	</query>

	<query name="getNewFilters">
		<![CDATA[
		from SoftwareFilter s 
		
		where	
			s.status = 'NEW'

		order by 
			s.softwareName ASC

		]]>
	</query>

	<query name="getFilterByNameByVersion">
		<![CDATA[
		from SoftwareFilter s 
		
		where	
			s.softwareName = :softwareName
			and s.softwareVersion = :softwareVersion

		]]>
	</query>

	<query name="softwareFilterHistoryYears">
		<![CDATA[
		select 
			distinct new com.ibm.tap.sigbank.reports.HistoryReport(year(m.recordTime))
		from 
			SoftwareFilterH m
		]]>
	</query>

	<query name="softwareFilterHistoryMonths">
		<![CDATA[
		select 
			distinct new com.ibm.tap.sigbank.reports.HistoryReport(monthname(m.recordTime),month(m.recordTime))
		from 
			SoftwareFilterH m
		where
			year(m.recordTime) = :year
		order by
			month(m.recordTime)
		]]>
	</query>

	<query name="softwareFilterHistoryByYearByMonth">
		<![CDATA[
		from 
			SoftwareFilterH s
			join fetch s.product
			join fetch s.softwareFilter
		where
			exists
			(
				from 
					SoftwareFilterH h 
				where 
					h.softwareFilter = s.softwareFilter 
					and year(h.recordTime) = :year
					and monthname(h.recordTime) = :month
			)
		order by
			s.softwareFilter ASC
			,s.recordTime DESC
		]]>
	</query>

	<query name="softwareFilterHistoryByYearByMonthCount">
		<![CDATA[
		select
			count(*)
		from 
			SoftwareFilterH s
		where
			exists(from SoftwareFilterH h where h.softwareFilter = s.softwareFilter and year(h.recordTime) = :year
			and monthname(h.recordTime) = :month)
		]]>
	</query>


























	<query name="softwareFiltersHistory">
		<![CDATA[
		from SoftwareFilterH s 
		
		where	
			s.softwareFilter = :softwareFilter

		]]>
	</query>




</hibernate-mapping>
