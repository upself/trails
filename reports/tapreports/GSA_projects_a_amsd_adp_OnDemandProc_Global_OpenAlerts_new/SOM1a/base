SELECT
	 r.name as "Region",
	 ccode.name as "Country",
	 c.customer_name as "Account Name",
	 c.account_number as "Account Number", 
	 CASE WHEN VA.Alert_Age > 90 THEN 'Red' WHEN VA.Alert_Age > 45 THEN 'Yellow' ELSE 'Green' END as "Status",
	 H.Serial as "Serial", 
	 MT.Name as "Machine type", 
	 MT.Type as "Asset type", 
	 VA.Creation_Time as "Create data/time", 
	 VA.Alert_Age as "Age", 
	 VA.Remote_User as "Assignee", 
	 VA.Comments as "Assignee comments", 
	 VA.Record_Time as "Assigned date/time",  
	 AC.name as "Cause Code (CC)", 
	 CC.target_date as "CC target date", 
	 CC.owner as "CC owner", 
	 CC.record_time as  "CC change date", 
	 CC.remote_user as "CC change person", 
	 CC.id as "Internal ID" 
	 
	FROM EAADMIN.V_Alerts VA
			join eaadmin.customer c on c.customer_id = va.customer_id
			join eaadmin.country_code ccode on ccode.id=c.country_code_id
			join eaadmin.region r on r.id = ccode.region_id
			join eaadmin.geography geo on r.geography_id=geo.id,
		EAADMIN.Hardware H, 
		EAADMIN.Machine_Type MT, 
		EAADMIN.cause_code CC, 
		EAADMIN.alert_cause AC
	WHERE 
			VA.Type = 'HARDWARE' AND 
			VA.Open = 1 AND 
			H.Id = VA.FK_Id AND 
			MT.Id = H.Machine_Type_Id and 
			VA.id=CC.alert_id and 
			CC.alert_type_id=3 and 
			CC.alert_cause_id=AC.id and
			geo.name=':geo:'
			
ORDER BY c.Customer_Name, H.Serial
with ur;
