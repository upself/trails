SELECT
	 r.name as "Region",
	 ccode.name as "Country",
	 c.customer_name as "Account Name",
	 c.account_number as "Account Number", 
	 CASE WHEN VA.Alert_Age > 90 THEN 'Red' WHEN VA.Alert_Age > 45 THEN 'Yellow' ELSE 'Green' END as "Status", 
	 SL.Name as "Hostname", 
	 SL.Bios_Serial as "Bios serial", 
	 VA.Creation_Time as "Create date/time", 
	 VA.Alert_Age as "Age", 
	 VA.Remote_User as "Assignee", 
	 VA.Comments as "Assignee comments", 
	 VA.Record_Time as "Assigned date/time", 
	 swlhw.machtyp "Asset Type",
	 swlhw.ostype "OS TYPE",
	 AC.name as "Cause Code (CC)", 
	 CC.target_date as "CC target date", 
	 CC.owner as "CC owner", 
	 CC.record_time as  "CC change date", 
	 CC.remote_user as "CC change person", 
	 CC.id as "Internal ID" 
	 
FROM 
	EAADMIN.V_Alerts VA
			join eaadmin.customer c on c.customer_id = va.customer_id
			join eaadmin.country_code ccode on ccode.id=c.country_code_id
			join eaadmin.region r on r.id = ccode.region_id
			join eaadmin.geography geo on r.geography_id=geo.id, 
	 EAADMIN.alert_cause AC, 
	 EAADMIN.cause_code CC, 
	 EAADMIN.Software_Lpar SL
left join
(select hsc.software_lpar_id sli, mt.type machtyp, hl.os_type ostype from EAADMIN.hw_sw_composite hsc, EAADMIN.hardware_lpar hl, EAADMIN.hardware h, EAADMIN.machine_type mt
where hsc.hardware_lpar_id = hl.id
and hl.hardware_id = h.id
and h.machine_type_id = mt.id
)as swlhw
on sl.id = swlhw.sli
	 
WHERE 
	 VA.Type = 'EXPIRED_SCAN' AND 
	 VA.Open = 1 AND 
	 SL.Id = VA.FK_Id and 
	 VA.id=CC.alert_id and 
	 CC.alert_type_id = 6 and 
	 CC.alert_cause_id=AC.id and
	 geo.name=':geo:'
	 
ORDER BY c.Customer_Name, SL.Name
with ur;
