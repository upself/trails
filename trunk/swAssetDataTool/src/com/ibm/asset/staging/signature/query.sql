select
ss.scan_record_id,
ss.software_id,
count(*)
from
scan_record sr,
software_lpar_map slm,
software_lpar sl,
software_signature ss
where
sr.id = slm.scan_record_id
and slm.software_lpar_id = sl.id
and ss.scan_record_id = sr.id
and sl.customer_id  = 642
and sr.bank_account_id in (
51,54,64,71,72,76,246,270,396,566,619,620,631,
660,663,672,673,674,675,676,681,685,686,687,689,
694,698,699,702,704,709,715,717,718,720,722,724,
726,728,729,730,731,733,737,738,740,742,743,745,
748,750,751,752,755,756,757,759,761,762,763,764,
768,769,770,779,780,782,786,787,788,789,790,791,
792,793,794,795,796,797,798,799,800,801,802,803,
804,805,806,807,809,810,811,814,815,816,818,819,
821,823,828,829,830,831,832,833,835,836,837,838,
839,840,841,842,843,844,845,846,852,853,854,855,
856,857,861,862,863,865,867,868,869,870,871,873,
875,876,877,878,879,880,884,885,886,887,888,889,
890,891,892,893,894,895,896,897,898,899,900,901,
902,904,905,906,907,908,909,910,914,917,918,919,
920,923,926,929,930,931,932,933,934,935,936,938,
939,941,943,944,945,946,947,948,949,950,951,952,
957,959,961,962,963,964,965,1088,1089,1090,1091,
1092,1094,1095,1096,1097,1098,1099,1100,1101,1102,
1103,1104,1106,1107,1108,1109
)
group by 
ss.scan_record_id,
ss.software_id
order by
count(*) desc
with ur
